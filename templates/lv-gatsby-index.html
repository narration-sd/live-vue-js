<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
    .lv-iframe {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
    }
    </style>

</head>
<body>
<noscript>
    <strong>We're sorry but Live Vue doesn't work properly without JavaScript enabled. Please enable it to continue.</strong>
</noscript>

{% hook "live-vue" %}
<iframe id="ifrm" name="live-vue" class="lv-iframe" src="https://lv-gatsby.test/page-5"></iframe>
<script>
    document.write('<div style="position: absolute; bottom: 5px; background: lightcoral;"><h6 style="margin: 2px 5px;">we are here</h6></div>')
</script>
<script>
function pushMessage () {

  var msg = // { text: 'from our Craft parent' }
    { text: document.getElementById('liveVue').innerText }
  // get reference to window in iframe
  console.log('preparing: ' + msg.text)
  var frame =  document.getElementById('ifrm')
  console.log('sending: ' + msg.text + ', to:' + frame.name)
  var win = frame.contentWindow
  // send msg to win
  win.postMessage( msg, "*" );
}

function timeMessage() {
  console.log('beginning timeout')
  setTimeout(pushMessage, 1); // *todo* even this, actually one tick, is enough??

}
window.addEventListener('load', timeMessage, false);
</script>
</body>
</html>
